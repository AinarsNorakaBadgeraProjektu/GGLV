import{r as C,u as B,j as e,B as I,g as ve,c as O,d as E,e as W,U as _e,h as U,i as X,p as oe,k as F,l as re,m as Ie,n as we,o as q,R as H,L as J,P as G,G as $,A as L,T as w,F as ae,a as Ne,f as D}from"./index-gyOQFbWm.js";import{A as R}from"./Accordion-B1TKSENF.js";import{g as ce}from"./get-auto-contrast-value-Da6zqqWm.js";import{I as T,c as Pe,u as $e}from"./Input-CUaF4mI9.js";import{u as Se}from"./use-uncontrolled-YvCjPSRu.js";import{C as le}from"./CheckIcon-DCh9biyr.js";import{D as ze}from"./Divider-D0-CmhI-.js";import{A as Ae}from"./Avatar-hRTT-35y.js";var ie={root:"m_5f75b09e",body:"m_5f6e695e",labelWrapper:"m_d3ea56bb",label:"m_8ee546b8",description:"m_328f68c0",error:"m_8e8a99cc"};const Me=ie,de=C.forwardRef(({__staticSelector:s,__stylesApiProps:n,className:t,classNames:r,styles:a,unstyled:h,children:u,label:c,description:p,id:m,disabled:x,error:b,size:f,labelPosition:g="left",bodyElement:y="div",labelElement:_="label",variant:o,style:d,vars:l,mod:i,...j},N)=>{const k=B({name:s,props:n,className:t,style:d,classes:ie,classNames:r,styles:a,unstyled:h});return e.jsx(I,{...k("root"),ref:N,__vars:{"--label-fz":ve(f),"--label-lh":O(f,"label-lh")},mod:[{"label-position":g},i],variant:o,size:f,...j,children:e.jsxs(I,{component:y,htmlFor:y==="label"?m:void 0,...k("body"),children:[u,e.jsxs("div",{...k("labelWrapper"),"data-disabled":x||void 0,children:[c&&e.jsx(I,{component:_,htmlFor:_==="label"?m:void 0,...k("label"),"data-disabled":x||void 0,children:c}),p&&e.jsx(T.Description,{size:f,__inheritStyles:!1,...k("description"),children:p}),b&&typeof b!="boolean"&&e.jsx(T.Error,{size:f,__inheritStyles:!1,...k("error"),children:b})]})]})})});de.displayName="@mantine/core/InlineInput";const he=C.createContext(null),Re=he.Provider,ue=()=>C.useContext(he),[Ge,Le]=Pe();var xe={card:"m_26775b0a"};const Fe={withBorder:!0},Te=U((s,{radius:n})=>({card:{"--card-radius":X(n)}})),K=E((s,n)=>{const t=W("CheckboxCard",Fe,s),{classNames:r,className:a,style:h,styles:u,unstyled:c,vars:p,checked:m,mod:x,withBorder:b,value:f,onClick:g,...y}=t,_=B({name:"CheckboxCard",classes:xe,props:t,className:a,style:h,classNames:r,styles:u,unstyled:c,vars:p,varsResolver:Te,rootSelector:"card"}),o=ue(),d=typeof m=="boolean"?m:(o==null?void 0:o.value.includes(f||""))||!1;return e.jsx(Ge,{value:{checked:d},children:e.jsx(_e,{ref:n,mod:[{"with-border":b,checked:d},x],..._("card"),...y,role:"checkbox","aria-checked":d,onClick:l=>{g==null||g(l),o==null||o.onChange(f||"")}})})});K.displayName="@mantine/core/CheckboxCard";K.classes=xe;function Be({children:s,role:n}){const t=$e();return t?e.jsx("div",{role:n,"aria-labelledby":t.labelId,"aria-describedby":t.describedBy,children:s}):e.jsx(e.Fragment,{children:s})}const Ee={},Q=E((s,n)=>{const{value:t,defaultValue:r,onChange:a,size:h,wrapperProps:u,children:c,readOnly:p,...m}=W("CheckboxGroup",Ee,s),[x,b]=Se({value:t,defaultValue:r,finalValue:[],onChange:a}),f=g=>{const y=typeof g=="string"?g:g.currentTarget.value;!p&&b(x.includes(y)?x.filter(_=>_!==y):[...x,y])};return e.jsx(Re,{value:{value:x,onChange:f,size:h},children:e.jsx(T.Wrapper,{size:h,ref:n,...u,...m,labelElement:"div",__staticSelector:"CheckboxGroup",children:e.jsx(Be,{role:"group",children:c})})})});Q.classes=T.Wrapper.classes;Q.displayName="@mantine/core/CheckboxGroup";var pe={indicator:"m_5e5256ee",icon:"m_1b1c543a","indicator--outline":"m_76e20374"};const We={icon:le},qe=U((s,{radius:n,color:t,size:r,iconColor:a,variant:h,autoContrast:u})=>{const c=oe({color:t||s.primaryColor,theme:s}),p=c.isThemeColor&&c.shade===void 0?`var(--mantine-color-${c.color}-outline)`:c.color;return{indicator:{"--checkbox-size":O(r,"checkbox-size"),"--checkbox-radius":n===void 0?void 0:X(n),"--checkbox-color":h==="outline"?p:F(t,s),"--checkbox-icon-color":a?F(a,s):ce(u,s)?re({color:t,theme:s,autoContrast:u}):void 0}}}),Y=E((s,n)=>{const t=W("CheckboxIndicator",We,s),{classNames:r,className:a,style:h,styles:u,unstyled:c,vars:p,icon:m,indeterminate:x,radius:b,color:f,iconColor:g,autoContrast:y,checked:_,mod:o,variant:d,disabled:l,...i}=t,j=m,N=B({name:"CheckboxIndicator",classes:pe,props:t,className:a,style:h,classNames:r,styles:u,unstyled:c,vars:p,varsResolver:qe,rootSelector:"indicator"}),k=Le(),V=typeof _=="boolean"||typeof x=="boolean"?_||x:(k==null?void 0:k.checked)||!1;return e.jsx(I,{ref:n,...N("indicator",{variant:d}),variant:d,mod:[{checked:V,disabled:l},o],...i,children:e.jsx(j,{indeterminate:x,...N("icon")})})});Y.displayName="@mantine/core/CheckboxIndicator";Y.classes=pe;var ge={root:"m_bf2d988c",inner:"m_26062bec",input:"m_26063560",icon:"m_bf295423","input--outline":"m_215c4542"};const Ve={labelPosition:"right",icon:le},De=U((s,{radius:n,color:t,size:r,iconColor:a,variant:h,autoContrast:u})=>{const c=oe({color:t||s.primaryColor,theme:s}),p=c.isThemeColor&&c.shade===void 0?`var(--mantine-color-${c.color}-outline)`:c.color;return{root:{"--checkbox-size":O(r,"checkbox-size"),"--checkbox-radius":n===void 0?void 0:X(n),"--checkbox-color":h==="outline"?p:F(t,s),"--checkbox-icon-color":a?F(a,s):ce(u,s)?re({color:t,theme:s,autoContrast:u}):void 0}}}),S=E((s,n)=>{const t=W("Checkbox",Ve,s),{classNames:r,className:a,style:h,styles:u,unstyled:c,vars:p,color:m,label:x,id:b,size:f,radius:g,wrapperProps:y,children:_,checked:o,labelPosition:d,description:l,error:i,disabled:j,variant:N,indeterminate:k,icon:V,rootRef:fe,iconColor:xs,onChange:A,autoContrast:ps,mod:be,...ye}=t,P=ue(),je=f||(P==null?void 0:P.size),Ce=V,M=B({name:"Checkbox",props:t,classes:ge,className:a,style:h,classNames:r,styles:u,unstyled:c,vars:p,varsResolver:De}),{styleProps:ke,rest:Z}=Ie(ye),ee=we(b),se=P?{checked:P.value.includes(Z.value),onChange:te=>{P.onChange(te),A==null||A(te)}}:{};return e.jsx(de,{...M("root"),__staticSelector:"Checkbox",__stylesApiProps:t,id:ee,size:je,labelPosition:d,label:x,description:l,error:i,disabled:j,classNames:r,styles:u,unstyled:c,"data-checked":se.checked||o||void 0,variant:N,ref:fe,mod:be,...ke,...y,children:e.jsxs(I,{...M("inner"),mod:{"data-label-position":d},children:[e.jsx(I,{component:"input",id:ee,ref:n,checked:o,disabled:j,mod:{error:!!i,indeterminate:k},...M("input",{focusable:!0,variant:N}),onChange:A,...Z,...se,type:"checkbox"}),e.jsx(Ce,{indeterminate:k,...M("icon")})]})})});S.classes={...ge,...Me};S.displayName="@mantine/core/Checkbox";S.Group=Q;S.Indicator=Y;S.Card=K;/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Oe=q("outline","arrow-left","IconArrowLeft",[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M5 12l6 6",key:"svg-1"}],["path",{d:"M5 12l6 -6",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var me=q("outline","check","IconCheck",[["path",{d:"M5 12l5 5l10 -10",key:"svg-0"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ue=q("outline","plus","IconPlus",[["path",{d:"M12 5l0 14",key:"svg-0"}],["path",{d:"M5 12l14 0",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Xe=q("outline","x","IconX",[["path",{d:"M18 6l-12 12",key:"svg-0"}],["path",{d:"M6 6l12 12",key:"svg-1"}]]);const He="_container_1k7fi_1",Je="_cashier_1k7fi_15",Ke="_content_1k7fi_37",Qe="_box_1k7fi_59",Ye="_panel_1k7fi_71",Ze="_products_1k7fi_89",es="_product_1k7fi_89",ss="_glow_1k7fi_119",v={container:He,cashier:Je,content:Ke,box:Qe,panel:Ye,products:Ze,product:es,glow:ss},ts=s=>{const n={};return s.forEach(r=>{const a=`${r.label}|${r.ingredients.sort().join(",")}`;n[a]||(n[a]={count:0,totalPrice:0,product:r}),n[a].count+=1,n[a].totalPrice+=r.price}),Object.keys(n).map(r=>{const{count:a,totalPrice:h,product:u}=n[r];return{...u,label:`${a} ${u.label}`,price:h}})},ns=({cart:s,removeItem:n,setMenu:t,complete:r})=>{const a=H(J),{cashier:h}=a,u=ts(s);return e.jsxs(I,{className:v.products,children:[e.jsx(G,{className:v.panel,mt:"xs",onClick:()=>{t("new")},children:e.jsxs($,{p:"xs",children:[e.jsx(L,{radius:2,size:25,variant:"light",color:"gray.3",children:e.jsx(Ue,{style:{display:"flex",height:"60%",width:"60%",alignItems:"center",alignContent:"center"}})}),e.jsx(w,{className:v.glow,children:h.add})]})}),s.length>0&&e.jsx(G,{className:v.panel,mt:"xs",mb:"xs",onClick:()=>{r()},children:e.jsxs($,{p:"xs",children:[e.jsx(L,{radius:2,size:25,variant:"light",color:"gray.3",children:e.jsx(me,{style:{display:"flex",height:"60%",width:"60%",alignItems:"center",alignContent:"center"}})}),e.jsx(w,{className:v.glow,children:h.complete})]})}),u.map((c,p)=>e.jsxs(G,{className:v.product,display:"block",mb:5,p:"xs",maw:"99%",children:[e.jsxs($,{children:[e.jsx(L,{radius:2,size:25,variant:"transparent",color:"red",onClick:()=>{n(c.name,c.ingredients)},children:e.jsx(Xe,{style:{display:"flex",height:"60%",width:"60%",alignItems:"center",alignContent:"center"}})}),e.jsx(w,{fz:"md",truncate:!0,c:"rgba(225,225,225,1)",children:c.label})]}),e.jsxs(ae,{ml:40,gap:0,justify:"flex-start",align:"flex-start",direction:"column",wrap:"wrap",children:[e.jsxs(w,{fz:"xs",children:[e.jsxs("a",{style:{fontWeight:500,color:"rgba(225,225,225,1)"},children:[a.price,": "]})," ",`$${c.price}`]}),e.jsxs(w,{fz:"xs",ta:"left",tt:"capitalize",children:[e.jsxs("a",{style:{fontWeight:500,color:"rgba(225,225,225,1)"},children:[a.ingredients,": "]}),`${c.ingredients.join(", ")}`]})]})]},p))]})},os="_panel_1aceq_1",rs="_glow_1aceq_19",as="_control_1aceq_37",cs="_accordionPanel_1aceq_65",ls="_input_1aceq_75",z={panel:os,glow:rs,control:as,accordionPanel:cs,input:ls},ne={name:"",label:"",ingredients:[],price:0};function is(s,n){const t=s.find(r=>r.value===n);return t?t.label:n}const ds=({allProducts:s,setMenu:n,addCart:t})=>{const r=H(J),{cashier:a}=r,[h,u]=C.useState(!1),[c,p]=C.useState([]),[m,x]=C.useState(ne),[b,f]=C.useState({}),g=o=>{if(!o){x(ne),f({});return}const d=s.find(i=>i.name===o);if(!d)return;const l={...d,ingredients:[]};x(l)},y=(o,d)=>{d?m.ingredients.includes(o)||x(i=>({...i,ingredients:[...i.ingredients,o]})):x(i=>({...i,ingredients:i.ingredients.filter(j=>j!==o)}));const l={...b};if(d){const i=l[m.name]||[];i.includes(o)||i.push(o),l[m.name]=i}else l[m.name]&&(l[m.name]=l[m.name].filter(i=>i!==o));f(l)},_=(o,d)=>b[o]?b[o].includes(d):!1;return C.useEffect(()=>{(async()=>{const d=await D("av_business","getIngredients");p(d),u(!0)})()},[]),h?e.jsxs(e.Fragment,{children:[e.jsx(G,{className:z.panel,mt:"xs",onClick:()=>{n("main")},children:e.jsxs($,{p:"xs",children:[e.jsx(L,{radius:2,size:25,variant:"light",color:"gray.3",children:e.jsx(Oe,{style:{display:"flex",height:"60%",width:"60%",alignItems:"center",alignContent:"center"}})}),e.jsx(w,{className:z.glow,children:a.return})]})}),e.jsx(R,{radius:"xs",onChange:o=>{g(o)},children:s==null?void 0:s.map(o=>{var d;return e.jsxs(R.Item,{value:o.name,mt:"xs",children:[e.jsx(R.Control,{classNames:{control:z.control},children:o.label}),e.jsxs(R.Panel,{className:z.accordionPanel,children:[e.jsxs(w,{fz:"xs",children:[e.jsxs("a",{style:{fontWeight:500,color:"rgba(225,225,225,1)"},children:[r.price,": "]})," ",`$${o.price?o.price:0}`]}),e.jsxs(w,{fz:"xs",fw:500,c:"rgba(225,225,225,1)",children:[r.ingredients,":"]}),e.jsx($,{mt:"xs",children:(d=o.ingredients)==null?void 0:d.map((l,i)=>e.jsx(S,{label:is(c,l),size:"xs",color:"cyan",classNames:{input:z.input},onChange:j=>y(l,j.currentTarget.checked),radius:"xl",checked:_(o.name,l)},i))}),e.jsx(I,{mt:"xs",style:{display:"flex",right:"0",textAlign:"right",justifyContent:"end"},children:e.jsx(Ne,{size:"xs",variant:"light",color:"cyan.3",onClick:()=>{t(m)},children:a.addCart})})]})]},o.name)})})]}):e.jsx(e.Fragment,{})},hs=(s,n,t)=>{const r=t.findIndex(a=>a.name===s&&us(a.ingredients,n));return r!==-1&&t.splice(r,1),[...t]},us=(s,n)=>{if(s.length!==n.length)return!1;const t=s.slice().sort(),r=n.slice().sort();return t.every((a,h)=>a===r[h])},vs=({serial:s})=>{const n=H(J),{cashier:t}=n,[r,a]=C.useState(!1),[h,u]=C.useState(""),[c,p]=C.useState("main"),[m,x]=C.useState([]),[b,f]=C.useState(0),[g,y]=C.useState([]),_=(l,i)=>{const j=hs(l,i,g);y(j)},o=l=>{const i=[...g,l];y(i)},d=async()=>{const l=await D("av_business","sendOrder",{serial:s,cart:g,total:b});l&&(u(l),a(!0))};return C.useEffect(()=>{(async()=>{const j=(await D("av_business","getProducts")).sort((N,k)=>N.label.localeCompare(k.label));x(j)})()},[]),C.useEffect(()=>{const l=g.reduce((i,j)=>i+j.price,0);f(l)},[g]),e.jsx(I,{className:v.container,children:e.jsx(I,{className:v.cashier,children:e.jsx(I,{className:v.content,children:e.jsx(I,{className:v.box,children:r?e.jsx(I,{style:{display:"flex",justifyContent:"center",alignContent:"center",alignItems:"center",height:"60vh"},children:e.jsxs(I,{display:"block",style:{display:"flex",justifyContent:"center",textAlign:"center"},children:[e.jsx(Ae,{color:"teal",radius:"xl",style:{boxShadow:"0px 1px 5px rgba(56,217,169,0.15)",textAlign:"center",marginLeft:"auto",marginRight:"auto"},size:"md",children:e.jsx(me,{size:"1.25rem"})}),e.jsx(w,{mt:"xs",c:"gray.5",className:v.glow,children:t.waiting}),e.jsx(w,{fw:500,c:"gray.2",className:v.glow,children:`${n.order} #${h}`})]})}):e.jsxs(e.Fragment,{children:[e.jsxs($,{justify:"space-between",p:"xs",children:[e.jsx(w,{fz:"lg",fw:500,className:v.glow,children:t.header}),e.jsxs(ae,{gap:0,justify:"flex-start",align:"flex-start",direction:"column",wrap:"wrap",children:[e.jsx(w,{fz:"sm",c:"gray.5",className:v.glow,children:`${t.products}: ${g.length}`}),e.jsx(w,{fz:"sm",c:"gray.5",className:v.glow,children:`${t.total}: $${b}`})]})]}),e.jsx(ze,{}),c=="main"?e.jsx(ns,{cart:g,removeItem:_,setMenu:p,complete:d}):e.jsx(ds,{setMenu:p,allProducts:m,addCart:o})]})})})})})};export{vs as default};
