const _0x12be73=_0x242a;!function(){for(var e=_0x242a,n=_0x34e7();;)try{if(666620==+parseInt(e(352))+parseInt(e(185))/2+parseInt(e(331))/3*(-parseInt(e(252))/4)+-parseInt(e(316))/5*(parseInt(e(358))/6)+-parseInt(e(336))/7*(parseInt(e(247))/8)+parseInt(e(359))/9*(parseInt(e(295))/10)+parseInt(e(317))/11*(parseInt(e(151))/12))break;n.push(n.shift())}catch(e){n.push(n.shift())}}();import{Post,getOwnedObjects}from"./api.js";import*as _0x5944dd from"three";import{TransformControls}from"three/addons/controls/TransformControls.js";let decorateMenu=null,editable=!1,editingData={};function setDecorateMenu(e){decorateMenu=e}const tracking={x:0,y:0},objectInfos={},furniData={prevY:[],prevX:[],prevZ:[],prevPitch:[],prevRoll:[],prevYaw:[]};let isTransforming=!1,editingId=null;const degToRad=e=>{var n=_0x242a,t={xVijd:function(e,n){return e*n},cPHfO:function(e,n){return e/n}};return t[n(211)](e,t[n(277)](Math.PI,180))},radToDeg=e=>{var n=_0x242a,t={qXUdP:function(e,n){return e*n},huvcE:function(e,n){return e/n}};return t[n(238)](e,t[n(184)](180,Math.PI))},selectLegacyObject=async e=>{var n=_0x242a,t={VTNWj:function(e,n){return e!=n},rBjIW:function(e,n){return e==n},afwRy:function(e){return e()},SzGiy:function(e,n){return e==n},ycONK:function(e,n){return e<n},gWeRz:function(e,n){return e!=n}};if(t[n(152)](decorateMenu,null)&&t[n(287)](decorateMenu[n(319)],2)){var r=await t[n(323)](getOwnedObjects);if(!t[n(181)](r[decorateMenu[n(248)][n(345)+"u"][n(167)]][n(288)],e)){for(var a=null,o=0;t[n(279)](o,r[n(292)]);o++)if(t[n(181)](r[o][n(288)],e)){a=o;break}t[n(267)](a,null)&&(decorateMenu[n(248)][n(345)+"u"][n(167)]=a),decorateMenu[n(248)][n(345)+"u"][n(319)]()}}},mouseDownHandler=async e=>{var n=_0x242a,t={XRJqN:function(e,n){return e&&n},ZZNng:function(e,n){return e!==n},NYEFJ:n(329),YJTmc:function(e,n,t){return e(n,t)},yOESo:n(318)+n(221),MhOYm:function(e,n){return e!==n},nUpZc:function(e,n){return e!=n},qTxDd:function(e,n){return e==n},TIFsv:function(e){return e()},iWoSS:function(e,n){return e==n},HbPTd:function(e,n){return e<n},elgCI:function(e,n){return e!=n},kMqEL:function(e){return e()},GWbOY:function(e,n){return e(n)},fKPSs:n(337),GuLjD:function(e){return e()}};if(!(isTransforming=!t[n(355)](isTransforming,!editingId)&&isTransforming)&&!t[n(178)](e[n(342)][n(349)],t[n(285)])){var e=tracking.x,r=tracking.y,a=await t[n(209)](Post,t[n(289)],{x:e,y:r});if(a[n(296)]&&t[n(243)](editingId,a[n(225)]))if(t[n(190)](decorateMenu,null)&&t[n(146)](decorateMenu[n(319)],2)){var o=await t[n(213)](getOwnedObjects);if(!t[n(264)](o[decorateMenu[n(248)][n(345)+"u"][n(167)]][n(288)],a[n(225)])){for(var i=null,c=0;t[n(294)](c,o[n(292)]);c++)if(t[n(146)](o[c][n(288)],a[n(225)])){i=c;break}t[n(298)](i,null)&&(decorateMenu[n(248)][n(345)+"u"][n(167)]=i),decorateMenu[n(248)][n(345)+"u"][n(319)]()}}else t[n(330)](clearData),editingId=a[n(225)],t[n(255)](changeEntity,editingId),isTransforming=!1;else if(!a[n(296)]){var u=t[n(144)][n(231)]("|");let e=0;for(;;){switch(u[e++]){case"0":if(t[n(298)](decorateMenu,null)&&t[n(146)](decorateMenu[n(319)],2))return;continue;case"1":transformControls[n(307)]=!1;continue;case"2":editingId=null;continue;case"3":t[n(266)](clearData);continue;case"4":isTransforming=!1;continue}break}}}},handleTracking=(window[_0x12be73(305)+_0x12be73(171)](_0x12be73(196),mouseDownHandler),e=>{var n=_0x12be73,t={DiQoI:function(e,n){return e-n},IegSA:function(e,n){return e-n},TMdLg:function(e,n,t){return e(n,t)},MkPBs:function(e,n,t){return e(n,t)}},r=t[n(180)](e[n(335)],e[n(342)][n(163)]),e=t[n(240)](e[n(291)],e[n(342)][n(163)]);tracking.x=t[n(188)](normalize,r,document[n(214)+n(328)][n(233)+"h"]),tracking.y=t[n(149)](normalize,e,document[n(214)+n(328)][n(333)+"ht"])}),Scene=new _0x5944dd[_0x12be73(276)],Renderer=new _0x5944dd[_0x12be73(207)+_0x12be73(197)]({alpha:!0}),Camera=(Renderer[_0x12be73(227)](window[_0x12be73(275)],window[_0x12be73(157)+"t"]),document[_0x12be73(242)+_0x12be73(216)](_0x12be73(300))[_0x12be73(168)+"d"](Renderer[_0x12be73(293)]),new _0x5944dd[_0x12be73(282)+_0x12be73(263)](50,window[_0x12be73(275)]/window[_0x12be73(157)+"t"],.1,1e4)),boxGeometry=(Camera[_0x12be73(239)][_0x12be73(212)]=_0x12be73(237),new _0x5944dd[_0x12be73(153)+"y"](1,1,1)),meshPhongMaterial=new _0x5944dd[_0x12be73(278)+_0x12be73(338)]({color:16711935,transparent:!0,opacity:0}),Mesh=new _0x5944dd[_0x12be73(325)](boxGeometry,meshPhongMaterial);Mesh[_0x12be73(239)][_0x12be73(212)]=_0x12be73(237),Mesh[_0x12be73(257)][_0x12be73(162)](1,1,1),Scene[_0x12be73(346)](Mesh),Renderer[_0x12be73(293)][_0x12be73(176)][_0x12be73(260)]=_0x12be73(177);let animationFrameActive=null;function _0x242a(e,n){const t=_0x34e7();return(_0x242a=function(e,n){return e-=143,t[e]})(e,n)}function renderGeometry(){var e=_0x12be73;animationFrameActive={xmmqn:function(e,n){return e(n)}}[e(309)](requestAnimationFrame,renderGeometry),Renderer[e(189)](Scene,Camera)}function showGeometry(){var e=_0x12be73,n={DzBNr:e(270)};transformControls[e(307)]=!1,Renderer[e(293)][e(176)][e(260)]=n[e(332)]}function hideGeometry(){var e=_0x12be73,n={yBUbY:e(177)};transformControls[e(307)]=!1,Renderer[e(293)][e(176)][e(260)]=n[e(251)]}function hideTransformControls(){var e=_0x12be73;transformControls[e(307)]=!1}const transformControls=new TransformControls(Camera,Renderer[_0x12be73(293)]),editEntity=(transformControls[_0x12be73(305)+_0x12be73(171)](_0x12be73(232),()=>{var e=_0x12be73,n={jqKdI:function(e,n){return e(n)},oZbvP:function(e,n){return e(n)},YMlgj:function(e){return e()}},t=objectInfos[editingId];Mesh[e(290)].x&&Mesh[e(290)].y&&Mesh[e(290)].z&&t&&(t.x=Mesh[e(290)].x,t.y=-Mesh[e(290)].z,t.z=Mesh[e(290)].y,t[e(160)]=n[e(219)](radToDeg,Mesh[e(239)].x),t[e(200)]=n[e(219)](radToDeg,-Mesh[e(239)].z),t[e(241)]=n[e(261)](radToDeg,Mesh[e(239)].y),n[e(271)](editEntity),Renderer[e(189)](Scene,Camera))}),()=>{var e=_0x12be73,n={crxZO:function(e,n,t){return e(n,t)},qVudi:e(173)+"y",TfUYq:function(e,n){return e(n)},nwNRK:function(e,n){return e(n)},ZCiWG:function(e,n){return e(n)},NjqLy:function(e,n){return e(n)},OLEDC:function(e,n){return e(n)}},t=objectInfos[editingId];n[e(360)](Post,n[e(220)],{id:editingId,alpha:n[e(265)](parseInt,t[e(192)]),x:n[e(265)](parseFloat,t.x),y:n[e(218)](parseFloat,t.y),z:n[e(224)](parseFloat,t.z),pitch:n[e(224)](parseFloat,t[e(160)]),roll:n[e(224)](parseFloat,t[e(200)]),yaw:n[e(351)](parseFloat,t[e(241)])}),n[e(245)](setObjectHelperValues,t)}),storeData=(transformControls[_0x12be73(305)+_0x12be73(171)](_0x12be73(341),()=>{var e=_0x12be73;isTransforming=!0,{OhVOp:function(e){return e()}}[e(315)](storeData)}),transformControls[_0x12be73(305)+_0x12be73(171)](_0x12be73(304),()=>{var e=_0x12be73,n=objectInfos[editingId];n&&(n.x=Mesh[e(290)].x,n.y=-Mesh[e(290)].z,n.z=Mesh[e(290)].y,isTransforming=!1)}),transformControls[_0x12be73(143)+_0x12be73(327)](.1),transformControls[_0x12be73(227)](.8),transformControls[_0x12be73(256)+_0x12be73(274)](degToRad(15)),transformControls[_0x12be73(223)](Mesh),Scene[_0x12be73(346)](transformControls),()=>{var n=_0x12be73,t={aSTlt:function(e,n){return e!==n},chayg:function(e,n){return e!==n},gcamy:n(246)+"0"},r=objectInfos[editingId];if(r&&t[n(354)](r.x,0)&&t[n(283)](r.y,0)&&t[n(354)](r.z,0)){var a=t[n(156)][n(231)]("|");let e=0;for(;;){switch(a[e++]){case"0":furniData[n(204)][n(191)](r[n(241)]);continue;case"1":furniData[n(272)][n(191)](r[n(200)]);continue;case"2":furniData[n(159)][n(191)](r.x);continue;case"3":furniData[n(228)][n(191)](r[n(160)]);continue;case"4":furniData[n(244)][n(191)](r.y);continue;case"5":furniData[n(320)][n(191)](r.z);continue}break}}});function cancelRenderGeometry(){var e=_0x12be73;animationFrameActive&&({RkaAQ:function(e,n){return e(n)}}[e(147)](cancelAnimationFrame,animationFrameActive),animationFrameActive=null)}function setEditMode(e){var n=_0x12be73,t={dVUBt:function(e,n){return e===n},XwQKf:n(347),JAJHe:n(206)};t[n(357)](e,t[n(194)])?transformControls[n(340)](t[n(194)]):transformControls[n(340)](t[n(311)])}function setRotationSnap(e){var n=_0x12be73;transformControls[n(256)+n(274)](e)}function setTranslationSnap(e){var n=_0x12be73;transformControls[n(143)+n(327)](e)}const normalize=(e,n)=>{var t=_0x12be73,r={hLNAl:function(e,n){return e+n},iANnc:function(e,n){return e/n},OKjVN:function(e,n){return e*n},CRMIp:function(e,n){return e-n}};return r[t(303)](r[t(343)](r[t(170)](1,r[t(312)](e,0)),r[t(312)](n,0)),0)},handleUpdatePositions=(window[_0x12be73(305)+_0x12be73(171)](_0x12be73(175),handleTracking),e=>{var n=_0x12be73,t={DynFr:function(e,n){return e(n)},vSXLt:function(e,n){return e(n)},PJCEn:function(e,n,t){return e(n,t)},ZBxuz:function(e,n){return e(n)},LeKkf:function(e,n){return e(n)}},r=(Camera[n(290)][n(162)](e[n(145)][n(290)].x,e[n(145)][n(290)].z,-e[n(145)][n(290)].y),e[n(145)][n(239)].x),a=e[n(145)][n(239)].z,o=e[n(145)][n(239)].y;Camera[n(239)][n(162)](t[n(235)](degToRad,r),t[n(229)](degToRad,t[n(154)](zRotationHandler,r,a)),t[n(334)](degToRad,o)),Camera[n(301)]=e[n(145)][n(301)],Camera[n(273)+n(217)+"ix"](),e[n(225)][n(290)]&&(Mesh[n(290)][n(162)](e[n(225)][n(290)].x,e[n(225)][n(290)].z,-e[n(225)][n(290)].y),Mesh[n(239)][n(162)](t[n(235)](degToRad,e[n(225)][n(239)].x),t[n(235)](degToRad,e[n(225)][n(239)].z),t[n(306)](degToRad,-e[n(225)][n(239)].y)))}),changeEntity=async e=>{var n=_0x12be73,t={elzbq:function(e,n,t){return e(n,t)},xqdbB:n(208)+n(148),dxMWL:function(e,n){return e(n)},nImmk:function(e,n){return e(n)}},e=await t[n(158)](Post,t[n(236)],{id:t[n(281)](parseInt,e)});t[n(284)](setEntityData,e)},zRotationHandler=(e,n)=>{var t=_0x12be73,r={nTdpY:function(e,n){return n<e},UljDH:function(e,n){return e<n},SxkIS:function(e,n){return n<e}};return(!r[t(280)](e,0)||!r[t(203)](e,90))&&(r[t(280)](e,-180)&&r[t(203)](e,-90)||r[t(286)](e,0))?-n:n},setEntityData=e=>{var n=_0x12be73,t={iDLZe:n(254)+n(299)+n(169)+n(302),dCylb:function(e,n){return e!==n},IVRUh:function(e){return e()},RYDhl:function(e,n){return e(n)}},r=t[n(234)][n(231)]("|");let a=0;for(;;){switch(r[a++]){case"0":editingData[n(192)]=e[n(192)];continue;case"1":editable=!0;continue;case"2":editingData.y=e.y;continue;case"3":editingData[n(200)]=e[n(200)];continue;case"4":editingData[n(166)]=e[n(166)];continue;case"5":transformControls[n(307)]=!0;continue;case"6":if(e[n(161)])continue;return editable=!1,void(transformControls[n(307)]=!1);case"7":t[n(198)](editingId,e.id)&&t[n(182)](clearData);continue;case"8":objectInfos[editingId]={id:e.id,hash:e[n(199)],alpha:e[n(192)],x:e.x,y:e.y,z:e.z,pitch:e[n(160)],roll:e[n(200)],yaw:e[n(241)],distance:e[n(166)],quaternion:{}};continue;case"9":editingData.z=e.z;continue;case"10":editingData[n(199)]=e[n(199)];continue;case"11":t[n(179)](setObjectHelperValues,e);continue;case"12":editingData.x=e.x;continue;case"13":editingData[n(160)]=e[n(160)];continue;case"14":editingId=e.id;continue;case"15":editingData[n(241)]=e[n(241)];continue}break}},setObjectHelperValues=e=>{var n=_0x12be73,t={iulbd:n(268)+n(308),bkSiS:function(e,n){return e(n)},wUXBe:n(201)+n(350)+n(269),NzOfC:n(201)+n(339)+n(172),QwKSe:n(201)+n(339)+n(249),weXkI:function(e,n){return e(n)},xaPih:n(201)+n(339)+n(155),FnukY:function(e,n){return e(n)},fdCyk:n(201)+n(339)+n(193),QRjPI:function(e,n){return e(n)},iDyoi:n(201)+n(339)+n(250),mpYCe:function(e,n){return e(n)},iMPcl:n(201)+n(339)+n(222)},r=t[n(262)][n(231)]("|");let a=0;for(;;){switch(r[a++]){case"0":t[n(165)]($,t[n(310)])[n(210)](e[n(199)]);continue;case"1":t[n(165)]($,t[n(183)])[n(210)](e[n(200)]);continue;case"2":t[n(165)]($,t[n(344)])[n(210)](e.x);continue;case"3":t[n(322)]($,t[n(230)])[n(210)](e[n(241)]);continue;case"4":t[n(164)]($,t[n(361)])[n(210)](e.y);continue;case"5":t[n(226)]($,t[n(321)])[n(210)](e[n(160)]);continue;case"6":t[n(187)]($,t[n(313)])[n(210)](e.z);continue}break}},clearData=()=>{var e=_0x12be73,n={DXzHz:e(258)+"4"}[e(215)][e(231)]("|");let t=0;for(;;){switch(n[t++]){case"0":furniData[e(244)]=[];continue;case"1":furniData[e(159)]=[];continue;case"2":furniData[e(228)]=[];continue;case"3":furniData[e(320)]=[];continue;case"4":furniData[e(204)]=[];continue;case"5":furniData[e(272)]=[];continue}break}};function _0x34e7(){const e=["ement","CANVAS","kMqEL","508425twAodp","DzBNr","scrollHeig","ZBxuz","pageX","5257JMZnTv","0|3|2|1|4","aterial","lper #enti","setMode","mouseDown","target","iANnc","QwKSe","sortingMen","add","rotate","lbaNH","tagName","lper #mode","NjqLy","238570igZWuZ","toggleMous","aSTlt","XRJqN","EXugq","dVUBt","6UKyixK","9alYpDo","crxZO","fdCyk","setTransla","fKPSs","cam","qTxDd","RkaAQ","y_info","MkPBs","keydown","16535532EvdXRW","VTNWj","BoxGeometr","PJCEn","ty-yaw","gcamy","innerHeigh","elzbq","prevX","pitch","exists","set","offsetTop","FnukY","bkSiS","distance","stash","appendChil","|9|13|3|15","OKjVN","stener","ty-roll","edit_entit","key","mousemove","style","none","ZZNng","RYDhl","DiQoI","SzGiy","IVRUh","NzOfC","huvcE","1416158wRSuus","lWeqi","mpYCe","TMdLg","render","nUpZc","push","alpha","ty-y","XwQKf","ect","mousedown","rer","dCylb","hash","roll","#object-he","McwnB","UljDH","prevYaw","GUDGo","translate","WebGLRende","load_entit","YJTmc","val","xVijd","order","TIFsv","documentEl","DXzHz","tor","ectionMatr","nwNRK","jqKdI","qVudi","ity","ty-z","attach","ZCiWG","entity","QRjPI","setSize","prevPitch","vSXLt","xaPih","split","change","scrollWidt","iDLZe","DynFr","xqdbB","YZX","qXUdP","rotation","IegSA","yaw","querySelec","MhOYm","prevY","OLEDC","2|4|5|3|1|","776zQRqtN","categories","ty-x","ty-pitch","yBUbY","28ACuQkh","eMovement","6|7|1|14|8","GWbOY","setRotatio","scale","0|1|3|2|5|","ground_obj","display","oZbvP","iulbd","eCamera","iWoSS","TfUYq","GuLjD","gWeRz","0|2|4|6|5|","l-name","block","YMlgj","prevRoll","updateProj","nSnap","innerWidth","Scene","cPHfO","MeshPhongM","ycONK","nTdpY","dxMWL","Perspectiv","chayg","nImmk","NYEFJ","SxkIS","rBjIW","handle","yOESo","position","pageY","length","domElement","HbPTd","1128390tykwzR","hit","jafbU","elgCI","|10|0|12|2","#decorate","fov","|4|5|11","hLNAl","mouseUp","addEventLi","LeKkf","visible","1|3","xmmqn","wUXBe","JAJHe","CRMIp","iMPcl","kAWAG","OhVOp","2558285dHRCXv","11Bregwi","select_ent","sort","prevZ","iDyoi","weXkI","afwRy","wUfSC","Mesh","toggleCurs","tionSnap"];return(_0x34e7=function(){return e})()}window[_0x12be73(305)+_0x12be73(171)](_0x12be73(150),async e=>{var n=_0x12be73,t={jafbU:function(e,n){return e===n},EXugq:function(e,n){return e(n)},wUfSC:n(353)+n(253),lbaNH:function(e,n){return e===n},kAWAG:n(326)+"or",GUDGo:function(e,n,t){return e(n,t)},McwnB:n(259)+n(195),lWeqi:function(e,n){return e(n)}};t[n(297)](e[n(174)],"F6")&&t[n(356)](Post,t[n(324)]),t[n(348)](e[n(174)],"F5")&&t[n(356)](Post,t[n(314)]),(t[n(297)](e[n(174)],"G")||t[n(348)](e[n(174)],"g"))&&(e=await t[n(205)](Post,t[n(202)],{id:t[n(356)](parseInt,editingId)}),t[n(186)](setEntityData,e))});export{setDecorateMenu,selectLegacyObject,renderGeometry,showGeometry,hideGeometry,hideTransformControls,cancelRenderGeometry,setEditMode,setRotationSnap,setTranslationSnap,handleUpdatePositions,changeEntity};